---

- name: create default group
  sudo: yes
  group: name={{ ansible_user_id }} state=present

- name: remove password prompt for default group
  sudo: yes
  lineinfile: "dest=/etc/sudoers state=present regexp='^%{{ ansible_user_id }}' line='%{{ ansible_user_id }} ALL=(ALL) NOPASSWD: ALL'"

- name: create default user
  sudo: yes
  user: name={{ ansible_user_id }} shell=/bin/bash group={{ ansible_user_id }}

- name: ensure .ssh folder exists
  sudo: yes
  file: path=/home/{{ ansible_user_id }}/.ssh state=directory
        owner={{ ansible_user_id }} group={{ ansible_user_id }}

- name: copy public ssh file to authorized_keys
  sudo: yes
  authorized_key: user={{ ansible_user_id }} key="{{ lookup('file', 'id_rsa.pub') }}"

